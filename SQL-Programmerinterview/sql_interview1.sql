-- Code to create schema
CREATE DATABASE SALES;
USE SALES;

CREATE TABLE SALESPERSON (
	ID INTEGER PRIMARY KEY NOT NULL,
	NAME VARCHAR(30),
    AGE INTEGER,
    SALARY INTEGER
);

CREATE TABLE CUSTOMER (
	ID INTEGER PRIMARY KEY NOT NULL,
	NAME VARCHAR(30),
    CITY VARCHAR(30),
    INDUSTRY_TYPE VARCHAR(1)
);

CREATE TABLE ORDERS(
	NUMBER INTEGER PRIMARY KEY NOT NULL,
    ORDER_DATE DATE,
    CUST_ID INTEGER,
    SALESPERSON_ID INTEGER,
    AMOUNT INTEGER,
    FOREIGN KEY (CUST_ID) REFERENCES CUSTOMER(ID),
    FOREIGN KEY (SALESPERSON_ID) REFERENCES SALESPERSON(ID)
) ENGINE = innodb;

-- Code to populate database

INSERT INTO SALESPERSON VALUES (1,'Abe',61,140000);
INSERT INTO SALESPERSON VALUES (2,'Bob',34,44000);
INSERT INTO SALESPERSON VALUES (5,'Chris',34,40000);
INSERT INTO SALESPERSON VALUES (7,'Dan',41,52000);
INSERT INTO SALESPERSON VALUES (8,'Ken',57,115000);
INSERT INTO SALESPERSON VALUES (11,'Joe',38,38000);

INSERT INTO  CUSTOMER VALUES (4,'Samsonic','pleasant','J');
INSERT INTO  CUSTOMER VALUES (6,'Panasung','oaktown','J');
INSERT INTO  CUSTOMER VALUES (7,'Samony','jackson','B');
INSERT INTO  CUSTOMER VALUES (9,'Orange','Jackson','B');

INSERT INTO ORDERS VALUES (10,STR_TO_DATE('8/2/96','%m/%d/%Y'),4,2,540);
INSERT INTO ORDERS VALUES (20,STR_TO_DATE('1/30/99','%m/%d/%Y'),4,8,1800);
INSERT INTO ORDERS VALUES (30,STR_TO_DATE('7/14/95','%m/%d/%Y'),9,1,460);
INSERT INTO ORDERS VALUES (40,STR_TO_DATE('1/29/98','%m/%d/%Y'),7,2,2400);
INSERT INTO ORDERS VALUES (50,STR_TO_DATE('2/3/98','%m/%d/%Y'),6,7,600);
INSERT INTO ORDERS VALUES (60,STR_TO_DATE('3/2/98','%m/%d/%Y'),6,7,720);
INSERT INTO ORDERS VALUES (70,STR_TO_DATE('5/6/98','%m/%d/%Y'),9,7,150);

/*
Given the tables above, find the following:
*/

/*
1 - The names of all salespeople that have an order with Samsonic.
*/
SELECT
	DISTINCT S.NAME
FROM
	SALESPERSON S
    JOIN ORDERS O
		ON S.ID = O.SALESPERSON_ID
	JOIN CUSTOMER C
		ON C.ID = O.CUST_ID
WHERE
	C.NAME = 'Samsonic';

/*
2 - The names of all salespeople that do not have any order with Samsonic.
*/
SELECT
	S.NAME
FROM
	SALESPERSON S
WHERE
	S.ID NOT IN
		(SELECT
			O.SALESPERSON_ID
		FROM
			ORDERS O
			JOIN CUSTOMER C
				ON O.CUST_ID = C.ID
		WHERE
			C.NAME = 'Samsonic');
/*	
3 - The names of salespeople that have 2 or more orders.
*/
SELECT
	S.NAME
FROM
	SALESPERSON S
WHERE
	S.ID IN
		(SELECT
				O.SALESPERSON_ID
			FROM
				ORDERS O
			GROUP BY
				O.SALESPERSON_ID
			HAVING
				COUNT(O.CUST_ID) >= 2);

/*
4 - Write a SQL statement to insert rows into a table called highAchiever(Name, Age), where a salesperson must have a salary of 100,000 or greater to be included in the table.
*/
INSERT INTO HIGH_ACHIEVER (NAME,AGE)
	(SELECT
		NAME,
		AGE
	FROM
		SALESPERSON
	WHERE
		SALARY > 100000);